webpackJsonp([0],{6167:function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__assets_js_cookieHandle__=__webpack_require__("xSLg");__webpack_exports__.a={components:{},data:function(){return{decimals:4,token_unit:"ESS",ico_count:0,token_price:0,token_offered:0,token_max:0,token_start_time:0,token_end_time:0,token_less_time:0,token_less_time_show:"",token_buy_amount:0,ico_start_time:"",ico_end_time:"",ico_price:0,ico_max:0,day:"00",hour:"00",minute:"00",second:"00",route_domain:route_domain}},mounted:function mounted(){if(!checkweb3())return console.log("钱包状态异常"),!1;var _vue=this;window.eventQueue={},window.loopBlock=function(lastblock){web3.eth.getBlockNumber().then(function(newblock){newblock>lastblock?(_vue.load_icoinfo(),web3.eth.getBlock(newblock).then(function(blockinfo){console.log(blockinfo),console.log(eventQueue);try{for(var i=0;i<blockinfo.transactions.length;i++){var txhash=blockinfo.transactions[i];for(var queuehash in eventQueue)if(txhash==queuehash){var funcname=eventQueue[queuehash];delete eventQueue[queuehash];try{eval(funcname+"('"+txhash+"')")}catch(t){console.log(t),console.log(funcname+"不存在")}}}}catch(t){}loopBlock(newblock)})):loopBlock(newblock)})},loopBlock(0),_vue.account_address=window.eth_account,_vue.load_icoinfo()},methods:{send_buy:function(){if(!checkweb3())return console.log("钱包状态异常"),!1;var t=this;essContract.methods.icoPrice().call(null,function(e,s){if(!e){var o=s.valueOf(),i=t.token_buy_amount*o;console.log("购买"+t.token_buy_amount+"个token，需花费"+web3.utils.fromWei(i.toString(),"ether")+"eth"),essContract.methods.buy().send({from:eth_account,value:i,gasPrice:web3.utils.toWei("20","gwei")},function(t,e){t||(eventQueue[e]="buy_done",window.buy_done=function(t){console.log("购买成功"+t)})})}})},load_icoinfo:function(){var t=this;essContract.methods.icoCount().call(null,function(e,s){e||(t.ico_count=s.valueOf())}),essContract.methods.icoPrice().call(null,function(e,s){if(!e){var o=web3.utils.fromWei(s.valueOf(),"ether");o=Number(o).toFixed(t.decimals),t.token_price=o}}),essContract.methods.offeredAmount().call(null,function(e,s){if(!e){var o=web3.utils.fromWei(s.valueOf(),"ether");o=Number(o).toFixed(t.decimals),t.token_offered=o}}),essContract.methods.maxAmount().call(null,function(e,s){if(!e){var o=web3.utils.fromWei(s.valueOf(),"ether");o=Number(o).toFixed(t.decimals),t.token_max=o}}),essContract.methods.endTime().call(null,function(e,s){e||(t.token_end_time=s.valueOf(),t.token_end_time>0&&(window.nowTime=Math.floor((new Date).getTime()/1e3),t.token_less_time=t.token_end_time-nowTime,t.timer||(t.timer=setInterval(function(){t.token_less_time--;var e=t.token_less_time,s=Math.floor(e/86400);e%=86400;var o=Math.floor(e/3600);e%=3600;var i=Math.floor(e/60),n=e%60;e>0?(t.day=s<10?"0"+s:s,t.hour=o<10?"0"+o:o,t.minute=i<10?"0"+i:i,t.second=n<10?"0"+n:n):(t.day="00",t.hour="00",t.minute="00",t.second="00")},1e3))))})}}}},LOND:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=s("6167"),i={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"content"},[s("div",{staticClass:"tokenbuy"},[s("div",{staticClass:"step2"},[s("div",{staticClass:"step2tit flex-box"},[s("div",{staticClass:"left flex-1"},[t._m(0),t._v("NO."),s("span",{staticClass:"strp2tit-num"},[t._v(t._s(t.ico_count))])]),t._v(" "),s("a",{staticClass:"right",attrs:{href:"https://fzmatthew.github.io/test"}},[t._v("\r\n        "+t._s(t.$t("m.tokenbuy.back"))+"\r\n      ")])]),t._v(" "),s("div",{staticClass:"stepbox box1"},[s("div",{staticClass:"box sale"},[s("div",{staticClass:"tit"},[t._v(t._s(t.$t("m.tokenbuy.total_sale"))+"("+t._s(t.$t("m.tokenbuy.unit"))+")")]),t._v(" "),s("div",{staticClass:"num"},[t._v(t._s(Number(t.token_max)))])]),t._v(" "),s("div",{staticClass:"box-flex2"},[s("div",{staticClass:"box"},[s("div",{staticClass:"tit"},[t._v(t._s(t.$t("m.tokenbuy.token_price")))]),t._v(" "),s("div",{staticClass:"num"},[t._v(t._s(t.token_price))]),t._v(" "),s("div",{staticClass:"unit"},[t._v("ETH")])]),t._v(" "),s("div",{staticClass:"box"},[s("div",{staticClass:"tit"},[t._v(t._s(t.$t("m.tokenbuy.count_down")))]),t._v(" "),s("div",{staticClass:"time-box flex-box"},[s("div",{staticClass:"day"},[s("div",{staticClass:"time-num"},[t._v(t._s(t.day))]),t._v(" "),s("div",{staticClass:"unit"},[t._v(t._s(t.$t("m.tokenbuy.day")))])]),t._v(" "),s("div",{staticClass:"hour time-list"},[s("div",{staticClass:"time-num"},[t._v(t._s(t.hour))]),t._v(" "),s("div",{staticClass:"unit"},[t._v(t._s(t.$t("m.tokenbuy.hour")))])]),t._v(" "),s("div",{staticClass:"minute time-list"},[s("div",{staticClass:"time-num"},[t._v(t._s(t.minute))]),t._v(" "),s("div",{staticClass:"unit"},[t._v(t._s(t.$t("m.tokenbuy.minute")))])]),t._v(" "),s("div",{staticClass:"second time-list"},[s("div",{staticClass:"time-num"},[t._v(t._s(t.second))]),t._v(" "),s("div",{staticClass:"unit"},[t._v(t._s(t.$t("m.tokenbuy.second")))])])])])])]),t._v(" "),s("div",{staticClass:"stepbox box2"},[s("div",{staticClass:"line1"},[s("div",{staticClass:"progressbar"},[s("div",{staticClass:"progressbar-inner",style:"width:"+t.token_offered/t.token_max*100+"%"},[s("div",{staticClass:"spot-box"},[t._m(1),t._v(" "),s("div",{staticClass:"percent"},[s("div",{staticClass:"percent-con"},[t._v(t._s(Number(t.token_offered/t.token_max*100).toFixed(2))+"%")])])])])])]),t._v(" "),s("div",{staticClass:"line2 flex-box"},[s("div",{staticClass:"line2-list flex-1 left"},[t._v(t._s(t.$t("m.tokenbuy.already_sold"))+" "),s("span",[t._v(t._s(t.token_offered))]),t._v(" "+t._s(t.token_unit))]),t._v(" "),s("div",{staticClass:"line2-list flex-1 right"},[t._v(t._s(t.$t("m.tokenbuy.surplus"))+" "),s("span",[t._v(t._s(t.token_max-t.token_offered))]),t._v(" "+t._s(t.token_unit))])])]),t._v(" "),s("div",{staticClass:"box3 flex-box"},[s("div",{staticClass:"line1"},[s("el-input-number",{attrs:{step:1,label:"购买token个数"},model:{value:t.token_buy_amount,callback:function(e){t.token_buy_amount=e},expression:"token_buy_amount"}})],1),t._v(" "),s("div",{staticClass:"line2 flex-1"},[s("el-button",{on:{click:function(e){t.send_buy()}}},[t._v(t._s(t.$t("m.tokenbuy.buy")))])],1)])]),t._v(" "),s("div",{staticClass:"footer"},[s("div",{staticClass:"line2"},[t._v(t._s(t.$t("m.public.footer.tip")))])])])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("span",{staticClass:"strp2tit-icon"},[e("em")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"spot"},[e("div",{staticClass:"spot-inner"})])}]};var n=function(t){s("ktOO")},a=s("C7Lr")(o.a,i,!1,n,"data-v-00640111",null);e.default=a.exports},ktOO:function(t,e){}});
//# sourceMappingURL=0.80242f9eee8f1676ba3f.js.map