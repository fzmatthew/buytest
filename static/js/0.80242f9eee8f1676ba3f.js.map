{"version":3,"sources":["webpack:///src/views/ico/buy.vue","webpack:///./src/views/ico/buy.vue?a8c6","webpack:///./src/views/ico/buy.vue"],"names":["__webpack_exports__","components","data","decimals","token_unit","ico_count","token_price","token_offered","token_max","token_start_time","token_end_time","token_less_time","token_less_time_show","token_buy_amount","ico_start_time","ico_end_time","ico_price","ico_max","day","hour","minute","second","route_domain","mounted","checkweb3","console","log","_vue","this","window","eventQueue","loopBlock","lastblock","web3","eth","getBlockNumber","then","newblock","load_icoinfo","getBlock","blockinfo","i","transactions","length","txhash","queuehash","funcname","eval","ex","account_address","eth_account","methods","send_buy","essContract","icoPrice","call","err","value","pricewei","valueOf","price","utils","fromWei","toString","buy","send","from","gasPrice","toWei","txreceipt","buy_done","icoCount","Number","toFixed","offeredAmount","amount","maxAmount","endTime","nowTime","Math","floor","Date","getTime","timer","setInterval","less_time","ico_buy","render","_vm","_h","$createElement","_c","_self","staticClass","_m","_v","_s","attrs","href","$t","style","step","label","model","callback","$$v","expression","on","click","$event","staticRenderFns","__vue_styles__","ssrContext","__webpack_require__","Component","normalizeComponent"],"mappings":"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","file":"js/0.80242f9eee8f1676ba3f.js","sourcesContent":["<template lang=\"html\">\r\n<div class=\"content\">\r\n\r\n<!-- step 2 -->\r\n<div class=\"tokenbuy\">\r\n<div class=\"step2\">\r\n    <div class=\"step2tit flex-box\">\r\n      <div class=\"left flex-1\"><span class=\"strp2tit-icon\"><em></em></span>NO.<span class=\"strp2tit-num\">{{ico_count}}</span> </div>\r\n      <a href='https://fzmatthew.github.io/test' class=\"right\">\r\n        {{$t('m.tokenbuy.back')}}\r\n      </a>\r\n    </div>\r\n    <div class=\"stepbox box1\">\r\n      <div class=\"box sale\">\r\n        <div class=\"tit\">{{$t('m.tokenbuy.total_sale')}}({{$t('m.tokenbuy.unit')}})</div>\r\n        <div class=\"num\">{{Number(token_max)}}</span></div>\r\n      </div>\r\n      <div class=\"box-flex2\">\r\n          <div class=\"box\">\r\n            <div class=\"tit\">{{$t('m.tokenbuy.token_price')}}</div>\r\n            <div class=\"num\">{{token_price}}</div>\r\n            <div class=\"unit\">ETH</div>\r\n        </div>\r\n        <div class=\"box\">\r\n            <div class=\"tit\">{{$t('m.tokenbuy.count_down')}}</div>\r\n            <div class=\"time-box flex-box\">\r\n                <div class=\"day\">\r\n                    <div class=\"time-num\">{{day}}</div>\r\n                    <div class=\"unit\">{{$t('m.tokenbuy.day')}}</div>\r\n                </div>\r\n                <div class=\"hour time-list\">\r\n                    <div class=\"time-num\">{{hour}}</div>\r\n                    <div class=\"unit\">{{$t('m.tokenbuy.hour')}}</div>\r\n                </div>\r\n                <div class=\"minute time-list\">\r\n                    <div class=\"time-num\">{{minute}}</div>\r\n                    <div class=\"unit\">{{$t('m.tokenbuy.minute')}}</div>\r\n                </div>\r\n                <div class=\"second time-list\">\r\n                    <div class=\"time-num\">{{second}}</div>\r\n                    <div class=\"unit\">{{$t('m.tokenbuy.second')}}</div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"stepbox box2\">\r\n      <div class=\"line1\">\r\n        <div class=\"progressbar\">\r\n            <div class=\"progressbar-inner\" :style=\"'width:'+(token_offered/token_max*100)+'%'\">\r\n                <div class=\"spot-box\">\r\n                    <div class=\"spot\">\r\n                        <div class=\"spot-inner\"></div>\r\n                    </div>\r\n                    <div class=\"percent\">\r\n                        <div class=\"percent-con\">{{Number(token_offered/token_max*100).toFixed(2)}}%</div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n      </div>\r\n      <div class=\"line2 flex-box\">\r\n        <div class=\"line2-list flex-1 left\">{{$t('m.tokenbuy.already_sold')}} <span>{{token_offered}}</span> {{token_unit}}</div>\r\n        <div class=\"line2-list flex-1 right\">{{$t('m.tokenbuy.surplus')}} <span>{{token_max - token_offered}}</span> {{token_unit}}</div>\r\n      </div>\r\n    </div>\r\n    <div class=\"box3 flex-box\">\r\n      <div class=\"line1\">\r\n        <el-input-number v-model=\"token_buy_amount\"   :step=\"1\" label=\"购买token个数\"></el-input-number>\r\n      </div>\r\n      <div class=\"line2 flex-1\"><el-button v-on:click=\"send_buy()\">{{$t('m.tokenbuy.buy')}}</el-button></div>\r\n    </div>\r\n    </div>\r\n    <div class=\"footer\">\r\n        <div class=\"line2\">{{$t('m.public.footer.tip')}}</div>\r\n    </div>\r\n</div>\r\n<!-- step 2 -->\r\n</div>\r\n</template>\r\n<script>\r\n  import { setCookie, getCookie } from '@/assets/js/cookieHandle'\r\nexport default {\r\n  components: {\r\n  },\r\n  data () {\r\n    return {\r\n        decimals:4, //显示的精度\r\n        token_unit:\"ESS\",       //单位\r\n        //ico\r\n        ico_count:0,    //ico次数，最多3\r\n        token_price:0,  //销售价\r\n        token_offered:0,  //本轮售出\r\n        token_max:0,//本轮总量\r\n        token_start_time:0,  //开始时间戳\r\n        token_end_time:0,    //结束时间戳\r\n        token_less_time:0,\r\n        token_less_time_show:\"\",\r\n        token_buy_amount:0,  //购买的数量\r\n\r\n        //管理员\r\n        ico_start_time:\"\",  //ico开始时间\r\n        ico_end_time:\"\",    //ico结束时间\r\n        ico_price:0,   //每个token的价格(ether)\r\n        ico_max:0,    //每次ico的最大数量\r\n        day:'00',\r\n        hour:'00',\r\n        minute:'00',\r\n        second:'00',\r\n\r\n        route_domain:route_domain\r\n\r\n    }\r\n  },\r\n  mounted () {\r\n\r\n          if(!checkweb3()){\r\n              console.log(\"钱包状态异常\");\r\n              return false;\r\n          }\r\n\r\n          var _vue = this;\r\n          //任务的队列，txrecipet=>funcname表示，轮询到对应的tx时，执行合约的方法\r\n          window.eventQueue = {};\r\n          //轮询区块信息，回调事件\r\n          window.loopBlock = function(lastblock){\r\n              web3.eth.getBlockNumber().then(function(newblock){\r\n                  //只处理新块\r\n                  if(newblock>lastblock){\r\n                      _vue.load_icoinfo();\r\n                      web3.eth.getBlock(newblock).then(function(blockinfo){\r\n                          console.log(blockinfo);\r\n                          console.log(eventQueue);\r\n                          try{\r\n                              for(var i=0;i<blockinfo.transactions.length;i++){\r\n                                  var txhash = blockinfo.transactions[i];\r\n                                  for(var queuehash in eventQueue){\r\n                                      if(txhash==queuehash){\r\n                                          var funcname = eventQueue[queuehash];\r\n                                          delete eventQueue[queuehash];\r\n                                          try{\r\n                                              eval(funcname+\"('\"+txhash+\"')\");\r\n                                          }catch(ex){\r\n                                              console.log(ex);\r\n                                              console.log(funcname+\"不存在\");\r\n                                          }\r\n                                      }\r\n                                  }\r\n                              }\r\n                          }catch(ex){\r\n\r\n                          }\r\n                          loopBlock(newblock);\r\n                      });\r\n                  }\r\n                  else\r\n                  {\r\n                      loopBlock(newblock);\r\n                  }\r\n              });\r\n          };\r\n          loopBlock(0);\r\n          //end loop\r\n\r\n          _vue.account_address = window.eth_account;\r\n          _vue.load_icoinfo();\r\n    },\r\n   methods:{\r\n\r\n     send_buy(){\r\n           if(!checkweb3()){\r\n               console.log(\"钱包状态异常\");\r\n               return false;\r\n           }\r\n           var _vue = this;\r\n           essContract.methods.icoPrice().call(null,function(err,value){\r\n                 if(!err){\r\n                     var pricewei = value.valueOf();\r\n                     var price = _vue.token_buy_amount * pricewei;\r\n                     var recommend_gas_price = \"20\";\r\n                     console.log(\"购买\"+_vue.token_buy_amount+\"个token，需花费\"+web3.utils.fromWei(price.toString(),\"ether\")+\"eth\");\r\n                     essContract.methods.buy().send({from: eth_account,value:price,gasPrice:web3.utils.toWei(recommend_gas_price,\"gwei\")},function(err,txreceipt){\r\n                         if(!err) {\r\n                             eventQueue[txreceipt] = \"buy_done\";\r\n                             window.buy_done = function (txhash) {\r\n                                 console.log(\"购买成功\" + txhash);\r\n                             };\r\n                         }\r\n                     });\r\n                 }\r\n           });\r\n\r\n       },\r\n\r\n     //加载ico信息\r\n     load_icoinfo(){\r\n         var _vue = this;\r\n         //ico次数\r\n         essContract.methods.icoCount().call(null,function(err,value){\r\n             if(!err){\r\n                 _vue.ico_count = value.valueOf();\r\n             }\r\n         });\r\n\r\n         //ico价格\r\n         essContract.methods.icoPrice().call(null,function(err,value){\r\n             if(!err){\r\n                 var price = web3.utils.fromWei(value.valueOf(),\"ether\");\r\n                 price = Number(price).toFixed(_vue.decimals);\r\n                 _vue.token_price = price;\r\n             }\r\n         });\r\n\r\n         //ico售出\r\n         essContract.methods.offeredAmount().call(null,function(err,value){\r\n             if(!err){\r\n                 var amount = web3.utils.fromWei(value.valueOf(),\"ether\");\r\n                 amount = Number(amount).toFixed(_vue.decimals);\r\n                 _vue.token_offered = amount;\r\n             }\r\n         });\r\n\r\n         //ico全部\r\n         essContract.methods.maxAmount().call(null,function(err,value){\r\n             if(!err){\r\n                 var amount = web3.utils.fromWei(value.valueOf(),\"ether\");\r\n                 amount = Number(amount).toFixed(_vue.decimals);\r\n                 _vue.token_max = amount;\r\n             }\r\n         });\r\n\r\n         //ico结束时间\r\n         essContract.methods.endTime().call(null,function(err,value){\r\n             if(!err){\r\n                 _vue.token_end_time = value.valueOf();\r\n                 if(_vue.token_end_time>0){\r\n                     window.nowTime = Math.floor(new Date().getTime()/1000);\r\n                     _vue.token_less_time = _vue.token_end_time - nowTime;\r\n                     if(!_vue.timer){\r\n                         _vue.timer = setInterval(function(){\r\n                             _vue.token_less_time--;\r\n                             var less_time = _vue.token_less_time;\r\n                             var day = Math.floor(less_time/(3600*24));\r\n                             less_time = less_time%(3600*24);\r\n                             var hour = Math.floor(less_time/3600);\r\n                             less_time = less_time%3600;\r\n                             var minute = Math.floor(less_time/60);\r\n                             var second = less_time%60;\r\n                             if (less_time>0) {\r\n                               if (day<10) {\r\n                               _vue.day=\"0\"+day;\r\n                               }else{\r\n                               _vue.day=day;\r\n                               }\r\n                               if (hour<10) {\r\n                               _vue.hour=\"0\"+hour;\r\n                               }else{\r\n                               _vue.hour=hour;\r\n                               }\r\n                               if (minute<10) {\r\n                               _vue.minute=\"0\"+minute;\r\n                               }else{\r\n                               _vue.minute=minute;\r\n                               }\r\n                               if (second<10) {\r\n                               _vue.second=\"0\"+second;\r\n                               }else{\r\n                               _vue.second=second;\r\n                               }\r\n                             }else{\r\n                               _vue.day=\"00\";\r\n                               _vue.hour=\"00\";\r\n                               _vue.minute=\"00\";\r\n                               _vue.second=\"00\";\r\n                             }\r\n                             // console.log(\"剩余时间\"+less_time);\r\n                             // _vue.token_less_time_show = day+\"天\"+hour+\"小时\"+minute+\"分钟\"+second+\"秒\";\r\n                         },1000);\r\n                     }\r\n                 }\r\n             }\r\n         });\r\n     },\r\n  },\r\n}\r\n</script>\r\n<style lang=\"less\" scoped>\r\n.tokenbuy{\r\n    position: relative;\r\n    min-height: 100%;\r\n    padding-bottom: 4.2rem;\r\n}\r\n.step2{\r\n    width:39.5rem;\r\n    margin:0 auto;\r\n    padding:5.6rem 0 8.9rem;\r\n    \r\n    .step2tit{\r\n        color: #949fc3;\r\n        line-height: 2rem;\r\n        .left{\r\n            position: relative;\r\n            padding-left: 1.5rem;\r\n            font-size: 1rem;\r\n            .strp2tit-num{\r\n                font-size: 1.2rem;\r\n                font-weight: bold;\r\n            }\r\n            .strp2tit-icon{\r\n                position: absolute;\r\n                display: block;\r\n                width: 0.5rem;\r\n                height: 0.5rem;\r\n                left: 3px;\r\n                top: 50%;\r\n                transform: translateY(-50%);\r\n                border-radius: 0.25rem;\r\n                background: #949fc3;\r\n                padding: 2px;\r\n                em{\r\n                    display: block;\r\n                    width: 100%;\r\n                    height: 100%;\r\n                    border-radius: 50%;\r\n                    background: #1b203c;\r\n                }\r\n            }\r\n        }\r\n        .right{\r\n            position: relative;\r\n            cursor: pointer;\r\n            padding-left: 1.2rem;\r\n            color: #949fc3;\r\n            &::after{\r\n                position: absolute;\r\n                display: block;\r\n                content: '\\E627';\r\n                font-family: 'iconfont';\r\n                color: #949fc3;\r\n                font-size: 0.8rem;\r\n                top: 50%;\r\n                left: 0;\r\n                transform: translateY(-50%);\r\n            }\r\n        }\r\n    }\r\n    .stepbox{\r\n        width:100%;\r\n        background:#fff;\r\n        border-radius:3px;\r\n        margin-bottom:1rem;\r\n        color:#888fa7;\r\n    }\r\n    .box1{\r\n        display: -webkit-box;\r\n        display: -webkit-flex;\r\n        display: flex;\r\n        -webkit-box-align: center;\r\n        -webkit-align-items: center;\r\n        align-items: center;\r\n        margin-top: 0.5rem;\r\n        text-align: center;\r\n        padding: 1.8rem 1.5rem 1.5rem;\r\n        .box{\r\n            -webkit-flex: 1;\r\n            -webkit-box-flex: 1;\r\n            flex: 1;\r\n            position: relative;\r\n            &::after{\r\n                position: absolute;\r\n                top: 0.8rem;\r\n                bottom: 0.1rem;\r\n                width: 1px;\r\n                right: 0;\r\n                background: #dde0ec;\r\n                display: block;\r\n                content: '';\r\n            }\r\n            &:last-child{\r\n                &::after{\r\n                    display: none;\r\n                }\r\n            }\r\n        }\r\n        .tit {\r\n            font-size: 0.8rem;\r\n            line-height: 2rem;\r\n        }\r\n        .num {\r\n            font-size: 2rem;\r\n            line-height: 2.4rem;\r\n            height: 2.4rem;\r\n            color:#3e4656;\r\n            span{\r\n                font-size: 0.7rem;\r\n            }\r\n        }\r\n        .unit {\r\n            line-height: 1.5rem;\r\n            height: 1.5rem;\r\n            font-size: 0.8rem;\r\n        }\r\n        .time-box {\r\n            justify-content: center;\r\n            .time-num{\r\n                font-size: 1.6rem;\r\n                height: 2.4rem;\r\n                line-height: 2.4rem;\r\n                color:#3e4656;\r\n            }\r\n            .time-list{\r\n                .time-num{\r\n                    position: relative;\r\n                    padding-left: 0.5rem;\r\n                    &::before{\r\n                        position: absolute;\r\n                        display: block;\r\n                        content:':';\r\n                        top: 50%;\r\n                        transform: translateY(-50%);\r\n                        left: 0;\r\n                        font-size: 1.6rem;\r\n                        line-height: 2.4rem;\r\n                    }\r\n                }\r\n                .unit {\r\n                    padding-left: 0.6rem;\r\n                }\r\n            }\r\n        }\r\n        .sale{\r\n            flex: 1;\r\n            .num,.unit{\r\n                color: #4588f3;\r\n            }\r\n        }\r\n        .box-flex2{\r\n            display: -webkit-box;\r\n            display: -webkit-flex;\r\n            display: flex;\r\n            -webkit-box-align: center;\r\n            -webkit-align-items: center;\r\n            align-items: center;\r\n            flex: 2;\r\n        }\r\n    }\r\n    .box-wap{\r\n        display: none;\r\n    }\r\n    .box2{\r\n        padding: 1.5rem;\r\n        .line1{\r\n            margin: 2.2rem 2.8rem 1.5rem;\r\n            .progressbar{\r\n                width: 100%;\r\n                height: 0.8rem;\r\n                border-radius: 0.4rem;\r\n                background: #d1d7e2;\r\n                .progressbar-inner{\r\n                    width: 32%;\r\n                    border-radius: 0.4rem;\r\n                    height: 0.8rem;\r\n                    background: #5a9aff;\r\n                    position: relative;\r\n                    .spot-box {\r\n                        position: absolute;\r\n                        top: 50%;\r\n                        transform: translateY(-50%);\r\n                        width: 2.2rem;\r\n                        height: 2.2rem;\r\n                        background: rgba(0,0,0,0.1);\r\n                        border-radius: 1.1rem;\r\n                        right: -0.8rem;\r\n                        padding: 0.2rem;\r\n                        .spot {\r\n                            width: 100%;\r\n                            height: 100%;\r\n                            background: #fff;\r\n                            border-radius: 50%;\r\n                            box-shadow: 0px 5px 15px 0px rgba(0,0,0,0.3);\r\n                            padding: 3px;\r\n                            .spot-inner {\r\n                                width: 100%;\r\n                                height: 100%;\r\n                                border-radius: 50%;\r\n                                background: #5a9aff;\r\n                                background: linear-gradient(#6bbcfa, #478bf3);\r\n                            }\r\n                        }\r\n                        .percent {\r\n                            position: absolute;\r\n                            top: -2.2rem;\r\n                            height: 1.5rem;\r\n                            line-height: 1.5rem;\r\n                            background: #5a9aff;\r\n                            background: linear-gradient(#74ccf9, #478bf3);\r\n                            color: #fff;\r\n                            min-width: 3.2rem;\r\n                            padding:0 .5rem;\r\n                            text-align: center;\r\n                            border-radius: 4px;\r\n                            left: 50%;\r\n                            transform: translateX(-50%);\r\n                            font-size: 1.2rem;\r\n                            &::before{\r\n                                position: absolute;\r\n                                display: block;\r\n                                content: '';\r\n                                width: 0;\r\n                                height: 0;\r\n                                margin-left: -6px;\r\n                                bottom: -5px;\r\n                                left: 50%;\r\n                                vertical-align: middle;\r\n                                border-top: 6px solid #5a9aff;\r\n                                border-right: 6px solid transparent;\r\n                                border-left: 6px solid transparent;\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        .line2 {\r\n            line-height: 2.2rem;\r\n            .line2-list {\r\n                position: relative;\r\n                padding-left: 1rem;\r\n                font-size: 0.8rem;\r\n                &::before {\r\n                    position: absolute;\r\n                    display: block;\r\n                    content: '';\r\n                    width: 0.6rem;\r\n                    height: 3px;\r\n                    border-radius: 2px;\r\n                    background: #888fa7;\r\n                    top: 1.25rem;\r\n                    left: 0;\r\n                }\r\n                span {\r\n                    font-size: 1.5rem;\r\n                    color: #3e4656;\r\n                    height: 2.2rem;\r\n                }\r\n            }\r\n        }\r\n    }\r\n    .box3{\r\n        margin-top: 1.8rem;\r\n    }\r\n    \r\n}\r\n@media only screen and (max-width: 800px) {\r\n    .tokenbuy{\r\n        .step2{\r\n            width: 100%;\r\n            padding-top: 0;\r\n            padding-bottom: 5rem;\r\n            .step2tit{\r\n                line-height: 3.6rem;\r\n                padding: 0 1rem;\r\n                .left{\r\n                    font-size: 1rem;\r\n                    .strp2tit-num{\r\n                        font-size: 1.4rem;\r\n                    }\r\n                }\r\n                .rigth{\r\n                    font-size: 0.8rem;\r\n                    .iconfont{\r\n                        font-size: 0.8rem;\r\n                    }\r\n                }\r\n            }\r\n            .box1{\r\n                display: block;\r\n                padding: 1rem;\r\n                border-radius: 0;\r\n                margin-top: 0;\r\n                margin-bottom: 0.6rem;\r\n                .num {\r\n                    font-size: 1.7rem;\r\n                }\r\n                .time-box {\r\n                    .time-num {\r\n                        font-size: 1.7rem;\r\n                        padding-left: 0.4rem;\r\n                        &::before{\r\n                            font-size: 1.7rem;\r\n                            line-height: 1.7rem;\r\n                            height: 1.7rem;\r\n                            top: 48%;\r\n                        }\r\n                    }\r\n                    .time-list {\r\n                        .time-num{\r\n                            padding-left: 0.4rem;\r\n                        }\r\n                        .unit{\r\n                            padding-left: 0.4rem;\r\n                        }\r\n                    }\r\n                }\r\n                .sale{\r\n                    &::after{\r\n                        display: none;\r\n                    }\r\n                }\r\n            }\r\n            .box2{\r\n                padding: 1rem;\r\n                border-radius: 0;\r\n                margin: 0;\r\n                .line1{\r\n                    margin: 2.4rem 0.5rem 1.4rem;\r\n                    .progressbar .progressbar-inner .spot-box{\r\n                        width: 1.8rem;\r\n                        height: 1.8rem;\r\n                        .percent{\r\n                            top: -1.9rem;\r\n                            width: 2.8rem;\r\n                            font-size: 0.9rem;\r\n                        }\r\n                    }\r\n                }\r\n                .line2{\r\n                    .line2-list{\r\n                        line-height: 1.2rem;\r\n                        padding: 0;\r\n                        &::before{\r\n                            display: none;\r\n                        }\r\n                        span{\r\n                            display: block;\r\n                            line-height: 1.4rem;\r\n                            height: 1.4rem;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            .box3{\r\n                display: block;\r\n                margin-top: 2.5rem;\r\n                padding: 0 1rem;\r\n                .line1{\r\n                    margin-bottom: 1rem;\r\n                    text-align: center;\r\n                }\r\n                .line2{\r\n                    width: 100%;\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n    .footer{\r\n        padding:.7rem 0;\r\n        width: 100%;\r\n        background: #1c2d57;\r\n        color:#5b6587;\r\n        text-align:center;\r\n        font-size:.7rem;\r\n        line-height:1.4rem;\r\n        position: absolute;\r\n        left: 0;\r\n        bottom: 0;\r\n    }\r\n</style>\r\n\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// src/views/ico/buy.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"content\"},[_c('div',{staticClass:\"tokenbuy\"},[_c('div',{staticClass:\"step2\"},[_c('div',{staticClass:\"step2tit flex-box\"},[_c('div',{staticClass:\"left flex-1\"},[_vm._m(0),_vm._v(\"NO.\"),_c('span',{staticClass:\"strp2tit-num\"},[_vm._v(_vm._s(_vm.ico_count))])]),_vm._v(\" \"),_c('a',{staticClass:\"right\",attrs:{\"href\":\"https://fzmatthew.github.io/test\"}},[_vm._v(\"\\r\\n        \"+_vm._s(_vm.$t('m.tokenbuy.back'))+\"\\r\\n      \")])]),_vm._v(\" \"),_c('div',{staticClass:\"stepbox box1\"},[_c('div',{staticClass:\"box sale\"},[_c('div',{staticClass:\"tit\"},[_vm._v(_vm._s(_vm.$t('m.tokenbuy.total_sale'))+\"(\"+_vm._s(_vm.$t('m.tokenbuy.unit'))+\")\")]),_vm._v(\" \"),_c('div',{staticClass:\"num\"},[_vm._v(_vm._s(Number(_vm.token_max)))])]),_vm._v(\" \"),_c('div',{staticClass:\"box-flex2\"},[_c('div',{staticClass:\"box\"},[_c('div',{staticClass:\"tit\"},[_vm._v(_vm._s(_vm.$t('m.tokenbuy.token_price')))]),_vm._v(\" \"),_c('div',{staticClass:\"num\"},[_vm._v(_vm._s(_vm.token_price))]),_vm._v(\" \"),_c('div',{staticClass:\"unit\"},[_vm._v(\"ETH\")])]),_vm._v(\" \"),_c('div',{staticClass:\"box\"},[_c('div',{staticClass:\"tit\"},[_vm._v(_vm._s(_vm.$t('m.tokenbuy.count_down')))]),_vm._v(\" \"),_c('div',{staticClass:\"time-box flex-box\"},[_c('div',{staticClass:\"day\"},[_c('div',{staticClass:\"time-num\"},[_vm._v(_vm._s(_vm.day))]),_vm._v(\" \"),_c('div',{staticClass:\"unit\"},[_vm._v(_vm._s(_vm.$t('m.tokenbuy.day')))])]),_vm._v(\" \"),_c('div',{staticClass:\"hour time-list\"},[_c('div',{staticClass:\"time-num\"},[_vm._v(_vm._s(_vm.hour))]),_vm._v(\" \"),_c('div',{staticClass:\"unit\"},[_vm._v(_vm._s(_vm.$t('m.tokenbuy.hour')))])]),_vm._v(\" \"),_c('div',{staticClass:\"minute time-list\"},[_c('div',{staticClass:\"time-num\"},[_vm._v(_vm._s(_vm.minute))]),_vm._v(\" \"),_c('div',{staticClass:\"unit\"},[_vm._v(_vm._s(_vm.$t('m.tokenbuy.minute')))])]),_vm._v(\" \"),_c('div',{staticClass:\"second time-list\"},[_c('div',{staticClass:\"time-num\"},[_vm._v(_vm._s(_vm.second))]),_vm._v(\" \"),_c('div',{staticClass:\"unit\"},[_vm._v(_vm._s(_vm.$t('m.tokenbuy.second')))])])])])])]),_vm._v(\" \"),_c('div',{staticClass:\"stepbox box2\"},[_c('div',{staticClass:\"line1\"},[_c('div',{staticClass:\"progressbar\"},[_c('div',{staticClass:\"progressbar-inner\",style:('width:'+(_vm.token_offered/_vm.token_max*100)+'%')},[_c('div',{staticClass:\"spot-box\"},[_vm._m(1),_vm._v(\" \"),_c('div',{staticClass:\"percent\"},[_c('div',{staticClass:\"percent-con\"},[_vm._v(_vm._s(Number(_vm.token_offered/_vm.token_max*100).toFixed(2))+\"%\")])])])])])]),_vm._v(\" \"),_c('div',{staticClass:\"line2 flex-box\"},[_c('div',{staticClass:\"line2-list flex-1 left\"},[_vm._v(_vm._s(_vm.$t('m.tokenbuy.already_sold'))+\" \"),_c('span',[_vm._v(_vm._s(_vm.token_offered))]),_vm._v(\" \"+_vm._s(_vm.token_unit))]),_vm._v(\" \"),_c('div',{staticClass:\"line2-list flex-1 right\"},[_vm._v(_vm._s(_vm.$t('m.tokenbuy.surplus'))+\" \"),_c('span',[_vm._v(_vm._s(_vm.token_max - _vm.token_offered))]),_vm._v(\" \"+_vm._s(_vm.token_unit))])])]),_vm._v(\" \"),_c('div',{staticClass:\"box3 flex-box\"},[_c('div',{staticClass:\"line1\"},[_c('el-input-number',{attrs:{\"step\":1,\"label\":\"购买token个数\"},model:{value:(_vm.token_buy_amount),callback:function ($$v) {_vm.token_buy_amount=$$v},expression:\"token_buy_amount\"}})],1),_vm._v(\" \"),_c('div',{staticClass:\"line2 flex-1\"},[_c('el-button',{on:{\"click\":function($event){_vm.send_buy()}}},[_vm._v(_vm._s(_vm.$t('m.tokenbuy.buy')))])],1)])]),_vm._v(\" \"),_c('div',{staticClass:\"footer\"},[_c('div',{staticClass:\"line2\"},[_vm._v(_vm._s(_vm.$t('m.public.footer.tip')))])])])])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('span',{staticClass:\"strp2tit-icon\"},[_c('em')])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"spot\"},[_c('div',{staticClass:\"spot-inner\"})])}]\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/_vue-loader@13.7.3@vue-loader/lib/template-compiler?{\"id\":\"data-v-00640111\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/_vue-loader@13.7.3@vue-loader/lib/selector.js?type=template&index=0!./src/views/ico/buy.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/_extract-text-webpack-plugin@3.0.2@extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-00640111\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!less-loader?{\\\"sourceMap\\\":true}!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=styles&index=0!./buy.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=script&index=0!./buy.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=script&index=0!./buy.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-00640111\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=template&index=0!./buy.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-00640111\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/ico/buy.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}